<!DOCTYPE html>
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!----------------------------------------- CDN JQUERY------------------------------------------------->


        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />

        <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

        <!----------------------------------------- LOCAL JQUERY ---------------------------------------------->
        <!--
         <link rel="stylesheet" href="./js/libs/jquery-mobile/jquery.mobile.css" />
         <script src="./js/libs/jquery/jquery-2.2.4.js"> </script>
         <script src="./js/libs/jquery-mobile/jquery.mobile.js"> </script>
        -->
        <link rel="stylesheet" href="./css/tg-theme.css"/>
        <script src="./js/libs/myUtils.js"></script>
        <script>
            //var homeUrl = "http://92.222.83.28/parent/home2.php";
            var homeUrl = "http://92.222.83.28/child/beat.php";

            window.onload = function (e) {
                //console.log("window loaded");
                doPost();
            };

            $(document).ready(function () {
                //console.log("document ready");
            });

            function doGetHomeInfo(timeFrame) {
                alert("connecting to " + homeUrl + "timeFrame=" + timeFrame);
                //http://92.222.83.28/parent/home2.php?time_frame=day
                $.ajax({
                    type: "get",
                    url: homeUrl,
                    dataType: 'text',
                    data: "time_frame=" + timeFrame,
                    success: function (data, textStatus, jqXHR) {
                        alert("data " + data);
                        var jsonObject = eval('(' + data + ')');
                        populateHome(jsonObject);
                    }
                });
            }

            window.receive = function (data) {
                alert("receive ww " + data.volumeInfo.title);
            };

            function doPost() {
                var url = "https://www.googleapis.com/books/v1/volumes/zyTCAlFPjgYC";

                alert("doPost");
                $.ajax({
                    url: 'http://92.222.83.28/parent/home2.php?time_frame=day',
                     //url: 'file:///home/chris/proxy/home2.php',
                    type: 'GET',
                    crossDomain: true,
                    jsonp: 'callback',
                    jsonpCallback: 'receive',
                    data: {
                        format: 'jsonp'
                    },
                    contentType: 'application/json',
                    error: function (jqXHR, textStatus, errorThrown) {
                        alert("error jqXHR=" + jqXHR + " textStatus=" + textStatus + " errorThrown=" + errorThrown);
                        var responseText = $.httpData(jqXHR);
                        alert(responseText);
                    },
                    dataType: 'jsonp',
                    success: function (data) {
                        alert("success " + data);
                    }
                });
            }

            function doPost2() {
                alert("doPost2");
                $.ajax({
                    type: "GET",
                    url: 'http://92.222.83.28/child/beat.php',
                    data: {
                        format: 'json'
                    },
                    success: function (response) {
                        alert('something');
                    },
                    error: function (XMLResponse) {
                        alert("XMLResponse " + XMLResponse.responseText);
                    }
                });
            }

            function errorMsg(result) {
                if (result.status == 200 && result.statusText == 'OK') {
                    alert("result.status=" + result.status);
                } else {
                    alert("FAILED : " + result.status + ' ' + result.statusText);
                }
            }

            function populateHome(jsonObject) {
                alert(jsonObject);
            }





            function doPost3() {



                alert("doPost3");
                $.ajax({
                    url: 'http://92.222.83.28/child/beat.php?',
                    jsonpCallback: 'receive',
                    jsonp: 'callback',
                    contentType: 'application/json',
                    dataType: 'jsonp',
                    crossDomain: true,
                    cache: false,
                    success: function (json) {
                        alert("success=" + json);
                    },
                    error: function (e) {
                        alert("error=" + e.message);
                    }
                }
                );
            }


            function AjaxFeed() {

                return $.ajax({
                    url: 'http://92.222.83.28/child/beat.php/',
                    data: {something: true},
                        dataType: 'jsonp',
                        /* Very important */
                        contentType: 'application/json',
                    });
                }

                function GetData()
                        AjaxFeed()

                        /* Everything worked okay. Hooray */
                        .done(function (data) {
                            alert("done data" + data);
                            return data;
                        })

                        /* Okay jQuery is stupid manually fix things */
                        .fail(function (jqXHR) {
                            alert("fail");
                    var responseText = $.httpData(jqXHR);
                        alert("jqXHR=" + responseText);
                            /* Build HTML and update */
                            var data = jQuery.parseJSON(jqXHR.responseText);

                            return data;
                    }
                    )
            ;



            /*
             
             (function($) {
             var url = "https://www.googleapis.com/books/v1/volumes/zyTCAlFPjgYC";
             //var url = "http://92.222.83.28/child/beat.php/";
             $.ajax({
             type: 'GET',
             url: url,
             // JSONP always async?
             //async: false,
             jsonp: "callback",
             jsonpCallback: 'jsonCallback',
             contentType: "application/json",
             dataType: 'jsonp',
             crossDomain: true,
             //success always called even when jsonpCallback is specified?
             success: function(json) {
             alert("success");
             console.dir(json);
             },
             // Error never called?
             error: function(e) {
             alert("error " + e.message);
             console.log(e.message);
             }
             });
             })(jQuery);
             
             function jsonCallback(json) {
             alert("callback "+ json.volumeInfo.title);
             
             }    */

        </script>

    </head>
    <body>
        <!-------------------------------HOME PAGE------------------------------------------- -->
        <div id="homePage" data-role="page">

            <div id="header" data-role="header" data-theme="a" data-position="fixed">
                <div id="headerNavbarId" data-role="navbar" >
                    <ul>
                        <li><a href="javascript:doGetHomeInfo('day')" data-iconshadow="false" class="ui-btn-active" >Day</a></li>
                        <li><a href="#" data-iconshadow="false">Week</a></li>
                        <li><a href="#" data-iconshadow="false">Month</a></li>
                    </ul>
                </div>
            </div>

            <div role="main" class="ui-content">
                <h1>Home Page</h1>
            </div><!-- /content -->

            <!-------------------------------FOOTER------------------------------------------- -->
            <div data-role="footer" data-theme="a" data-position="fixed">
                <div id="footerNavbarId" data-role="navbar" >
                    <ul>
                        <li><a href="#" data-icon="phone" data-iconshadow="false" data-iconpos="notext"></a></li>
                        <li><a href="#" data-icon="camera" data-iconshadow="false"  data-iconpos="notext"></a></li>
                        <li><a href="#" data-icon="home" data-iconshadow="false"  data-iconpos="notext" class="ui-btn-active"></a></li>
                        <li><a href="#" data-icon="location" data-iconshadow="false"  data-iconpos="notext"></a></li>
                        <li><a onclick="loadGeofences()" href="#editGeofencesPage" data-icon="tag" data-iconshadow="false"  data-iconpos="notext"></a></li>
                    </ul>
                </div>
            </div>
            <!-------------------------------/FOOTER------------------------------------------- -->
        </div><!-- /page -->
        <!-------------------------------/HOME PAGE------------------------------------------- -->

    </body>
</html>
